<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title>药店连锁-热卖商品维护</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<link href="../../css/font-awesome.min.css?v=4.4.0" rel="stylesheet">
		<link href="../../css/animate.min.css" rel="stylesheet">
		<link href="../../css/plugins/summernote/summernote.css" rel="stylesheet">
		<link href="../../css/plugins/summernote/summernote-bs3.css" rel="stylesheet">

		<link href="../../css/bootstrap.min.css?v=3.3.5" rel="stylesheet">
		<link href="../../css/style.min.css?v=4.0.0" rel="stylesheet">

		<link rel="stylesheet" type="text/css" href="../../css/common.css" />
		<link rel="stylesheet" href="../../css/raw_table.css">

		<script type="text/javascript" src="../../js/jquery-3.0.0.min.js"></script>
		<script src="../../js/bootstrap.min.js?v=3.3.5"></script>
		
		
		<script src="../../js/content.min.js?v=1.0.0"></script>
		<!--<script src="../../js/plugins/summernote/summernote.min.js"></script>-->
		<!--<script src="../../js/plugins/summernote/summernote-zh-CN.js"></script>-->

		<script type="text/javascript" src="../../js/common.js"></script>
		<script type="text/javascript" src="../../js/config.js"></script>
		<script src="../../js/template.js"></script>
		<script src="../../js/plugins/validate/jquery.validate.min.js"></script>
		<script src="../../js/plugins/suggest/bootstrap-suggest.min.js"></script>
		<script src="../../js/hi_home.js"></script>
		<script src="https://unpkg.com/wangeditor@3.1.1/release/wangEditor.min.js"></script>

		<style>
			#table_tpl_div1 .resultListInfo:hover {
				background-color: lightgray;
			}
			.w-e-toolbar{
				flex-wrap: wrap;
			}
			.w-e-toolbar .w-e-menu:nth-of-type(1),
			.w-e-toolbar .w-e-menu:nth-of-type(3),
			.w-e-toolbar .w-e-menu:nth-of-type(4),
			.w-e-toolbar .w-e-menu:nth-of-type(8),
			.w-e-toolbar .w-e-menu:nth-of-type(9){
				z-index: 10002 !important;
			}
		</style>
	</head>

	<body>

		<div class="contain" style="height:100%;overflow:hidden">
			<div class="rightLoadContent" style="display:flex;height:100%;">
				<!--页面数据呈现区-->

				<!--左系列-->
				<div class="disContents" style="width: 30%;margin-right: 5px;border-right: 1px solid grey;padding-right: 5px;">
					<div class="resultLists">
						<!--列表表头-->
						<div class="resultListsTitle">
							<div class="resultListsItem2 lf LiTextAlign">
								序号
							</div>
							<div class="resultListsItem3 lf LiTextAlign">
								系列名称
							</div>

							<div class="resultListsItem4 lf LiTextAlign">
								操作
							</div>
						</div>
						<div class="resultListsContents" id="table_tpl_div1">

						</div>
					</div>

					<div class="searchInfos">
						<div class=" addData" style="margin: 0 auto;float: none;margin-top: 50px;" data-toggle="modal" data-target="#myModal1">
							新增
						</div>
					</div>

					<div class="clearfix"></div>
				</div>
				<!--右内容列表-->
				<div style="width: 70%;height: 100%;overflow:scroll; ">
					<div class="disContents">
						<!--搜素区域-->
						<div class="searchInfos">
							<div id="r_add_div" class="rt addData" data-toggle="modal" data-target="#myModal2" style="display: none">
								新增
							</div>
						</div>
						<!--列表区域-->
						<div class="resultLists">
							<!--列表表头-->
							<div class="resultListsTitle">
								<div class="resultListsItem2 lf LiTextAlign">
									序号
								</div>
								<div class="resultListsItem2 lf LiTextAlign">
									药品名称
								</div>
								<div class="resultListsItem2 lf LiTextAlign">
									价格(元)
								</div>
								<div class="resultListsItem2 lf LiTextAlign">
									图片
								</div>
								<div class="resultListsItem2 lf LiTextAlign">
									背景图片
								</div>
								<div class="resultListsItem2 lf LiTextAlign">
									其他
								</div>
								<div class="resultListsItem3 lf LiTextAlign">
									操作
								</div>
							</div>
							<div class="resultListsContents" id="table_tpl_div2">

							</div>
						</div>
						<div class="clearfix"></div>
					</div>
					<div class="disContents" style="margin-top: 50px;">
						<!--搜素区域-->
						<div class="searchInfos">
							<div id="r_add_div2" class="rt addData" data-toggle="modal" data-target="#myModal3" style="display: none">
								新增
							</div>
						</div>
						<!--列表区域-->
						<div class="resultLists">
							<!--列表表头-->
							<div class="resultListsTitle">
								<div class="resultListsItem2 lf LiTextAlign">
									序号
								</div>
								<div class="resultListsItem2 lf LiTextAlign">
									药品名称
								</div>
								<div class="resultListsItem2 lf LiTextAlign">
									图片
								</div>
								<div class="resultListsItem2 lf LiTextAlign">
									其他
								</div>
								<div class="resultListsItem3 lf LiTextAlign">
									操作
								</div>
							</div>
							<div class="resultListsContents" id="table_tpl_div3">

							</div>
						</div>
						<div class="clearfix"></div>
					</div>
				</div>
			</div>
		</div>

		<!--table模板-->
		<!--左系列-->
		<script id="table_tpl1" type="text/html">
			<%for(var i=0;i< data.length;i++){%>
			<div class="resultListInfo" onclick="rigclick(this)" data-id="<%=data[i].id%>">
				<!--<div class="resultListsItem2 lf items LiTextAlign"><%=data[i].typeSort%></div>-->
				<div class="resultListsItem2 lf items LiTextAlign">
					<%=i+1%>
				</div>
				<div class="resultListsItem3 lf items LiTextAlign">
					<%=data[i].title%>
				</div>

				<div class="resultListsItem2 lf items LiTextAlign btnTextColor">
					<span class="changeImg" data-index="<%=i%>" onclick="left_update(this)" data-toggle="modal" data-target="#myModal1">修改</span>
				</div>
				<div class="resultListsItem2 lf items LiTextAlign btnTextColor">
					<span data-id="<%=data[i].id%>" onclick="left_del(this)" class="delImg">删除</span>
				</div>
				<div class="resultListsItem2 lf items LiTextAlign ">
					<span data-index="<%=i%>" onclick="left_shang(this)" class="btnTextColor  glyphicon glyphicon-arrow-up"></span>
					<span data-index="<%=i%>" onclick="left_xia(this)" class="btnTextColor  glyphicon glyphicon-arrow-down"></span>
				</div>
			</div>
			<%}%>
		</script>
		<!--右内容-->
		<script id="table_tpl2" type="text/html">
			<%for(var i=0;i< data.length;i++){%>
			<div class="resultListInfo">
				<div class="resultListsItem2 lf items LiTextAlign">
					<%=data[i].bannerSort%>
				</div>
				<div class="resultListsItem2 lf items LiTextAlign">
					<%=data[i].title%>
				</div>
				<div class="resultListsItem2 lf items LiTextAlign">
					<%=data[i].price%>
				</div>
				<div class="resultListsItem2 lf items LiTextAlign"><img src="<%=data[i].bannerUrl%>" height="100%"></div>
				<div class="resultListsItem2 lf items LiTextAlign"><img src="<%=data[i].bjUrl%>" height="100%"></div>
				<div class="resultListsItem2 lf items LiTextAlign">
					<%=data[i].memo%>
				</div>

				<div class="resultListsItem1 lf items LiTextAlign btnTextColor">
					<span data-index="<%=i%>" class="changeImg" onclick="r_update(this)" data-toggle="modal" data-target="#myModal2">修改</span>
				</div>
				<div class="resultListsItem1 lf items LiTextAlign btnTextColor">
					<span data-id="<%=data[i].id%>" onclick="r_del(this)" class="delImg">删除</span>
				</div>
				<div class="resultListsItem2 lf items LiTextAlign ">
					<span data-index="<%=i%>" onclick="r_shang(this)" class="btnTextColor  glyphicon glyphicon-arrow-up"></span>
					<span data-index="<%=i%>" onclick="r_xia(this)" class="btnTextColor  glyphicon glyphicon-arrow-down"></span>
				</div>
			</div>
			<%}%>
		</script>
		<!--右2模板-->
		<script id="table_tpl3" type="text/html">
			<%for(var i=0;i< data.length;i++){%>
			<div class="resultListInfo">
				<div class="resultListsItem2 lf items LiTextAlign">
					<%=data[i].bannerSort%>
				</div>
				<div class="resultListsItem2 lf items LiTextAlign">
					<%=data[i].title%>
				</div>
				<div class="resultListsItem2 lf items LiTextAlign"><img src="<%=data[i].bannerUrl%>" height="100%"></div>
				<div class="resultListsItem2 lf items LiTextAlign">
					<%=data[i].memo%>
				</div>

				<div class="resultListsItem1 lf items LiTextAlign btnTextColor">
					<span data-index="<%=i%>" class="changeImg" onclick="r_update2(this)" data-toggle="modal" data-target="#myModal3">修改</span>
				</div>
				<div class="resultListsItem1 lf items LiTextAlign btnTextColor">
					<span data-id="<%=data[i].id%>" onclick="r_del2(this)" class="delImg">删除</span>
				</div>
				<div class="resultListsItem2 lf items LiTextAlign ">
					<span data-index="<%=i%>" onclick="r_shang2(this)" class="btnTextColor  glyphicon glyphicon-arrow-up"></span>
					<span data-index="<%=i%>" onclick="r_xia2(this)" class="btnTextColor  glyphicon glyphicon-arrow-down"></span>
				</div>

			</div>
			<%}%>
		</script>

		<!--左系列新增模态框-->
		<div class="modal inmodal fade" id="myModal1" tabindex="-1" role="dialog" aria-hidden="true">
			<div class="modal-dialog ">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                        class="sr-only">Close</span></button>
						<h4 class="modal-title">新增系列名称</h4>
					</div>
					<div class="modal-body">
						<form class="form-horizontal m-t" id="xlForm">
							<div class="form-group">
								<label class="col-sm-4 control-label">系列名称：</label>
								<div class="col-sm-6">
									<input class="form-control" type="text" name="title" id="left_title">
								</div>
							</div>

							<input type="hidden" value="233" name="visitUrl">
							<input type="hidden" value="" id="left_up_id" name="id">
						</form>
					</div>

					<div class="modal-footer">
						<button type="button" onclick="xldosubmit()" class="btn btn-primary">保存</button>
						<button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
					</div>
				</div>
			</div>
		</div>
		<!--右内容新增-->
		<div class="modal inmodal fade" id="myModal2" tabindex="-1" role="dialog" aria-hidden="true">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                        class="sr-only">Close</span></button>
						<h4 class="modal-title" id="allot_title">系列商品保存</h4>
					</div>
					<div class="modal-body">
						<form class="form-horizontal m-t" id="yaoForm">

							<div class="form-group">
								<label class="col-sm-2 control-label">药品名称：</label>
								<div class="col-sm-6">
									<div class=" input-group">
										<input type="text" class="form-control" id="ryaoName" name="title">
										<div class="input-group-btn">
											<button type="button" class="btn btn-white dropdown-toggle" data-toggle="dropdown">
                                        <span class="caret"></span>
                                    </button>
										</div>
										<ul class="dropdown-menu dropdown-menu-right scrollHeight" role="menu">
										</ul>
									</div>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">副标题：</label>
								<div class="col-sm-6">
									<input id="memo" name="memo" maxlength="10" class="form-control" type="text">
								</div>
							</div>

							<div class="form-group">
								<label class="col-sm-2 control-label">价格：</label>
								<div class="col-sm-6">
									<input name="price" id="price"readonly="readonly" class="form-control" type="number" />
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">商品图片：</label>
								<div class="col-sm-6">

									<input style="display: none;" onchange="img1Upload(this)" class="form-control" type="file" id="bannerImg" />
									<span onclick="filebtnclick(this)" class="glyphicon glyphicon-open fileBtn"></span>
									<img id="bannerUrl_img" class="simg" src="">
									<button id="bannerUrl_idelbtn" onclick="delImg_banner(this)" class="btn btn-warning btn-circle simg_del" type="button"><i class="fa fa-times"></i></button>
								</div>
							</div>

							<div class="form-group">
								<label class="col-sm-2 control-label">背景图片(用于web)：</label>
								<div class="col-sm-6">
									<input style="display: none;" onchange="img2Upload(this)" class="form-control" type="file" id="bgImg" />
									<span onclick="filebtnclick(this)" class="glyphicon glyphicon-open fileBtn"></span>
									<img id="bjUrl_img" class="simg" src="">
									<button id="bannerUrl_idelbtn1" onclick="delImg_banner(this)" class="btn btn-warning btn-circle simg_del" type="button"><i class="fa fa-times"></i></button>
								</div>
							</div>

							<div class="form-group">
								<label class="col-sm-2 control-label">描述：</label>
								<div class="col-sm-8">
									<!--<div class="summernote">
										请输入描述...
									</div>-->
									<div id="richText"></div>
								</div>
							</div>

							<input name="content" id="content" class="form-control" type="hidden" />

							<input type="hidden" name="bannerUrl" id="bannerUrl">
							<input type="hidden" name="bjUrl" id="bjUrl">
							<input type="hidden" name="accessPath" id="rec" value="296">
							<input type="hidden" name="type" id="par_type">

							<input id="r_up_id" name="id" type="hidden">
						</form>
					</div>
					<div class="modal-footer">
						<button type="button" onclick="yaodosubmit()" class="btn btn-primary">保存</button>
						<button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
					</div>
				</div>
			</div>
		</div>
		<!--右2内容新增-->
		<div class="modal inmodal fade" id="myModal3" tabindex="-1" role="dialog" aria-hidden="true">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                        class="sr-only">Close</span></button>
						<h4 class="modal-title">热卖商品保存</h4>
					</div>
					<div class="modal-body">
						<form class="form-horizontal m-t" id="yaoForm2">

							<div class="form-group">
								<label class="col-sm-4 control-label">药品名称：</label>
								<div class="col-sm-6">
									<div class=" input-group">
										<input type="text" class="form-control" id="ryaoName2" name="title">
										<div class="input-group-btn">
											<button type="button" class="btn btn-white dropdown-toggle" data-toggle="dropdown">
                                        <span class="caret"></span>
                                    </button>
										</div>
										<ul class="dropdown-menu dropdown-menu-right scrollHeight" role="menu">
										</ul>
									</div>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">副标题：</label>
								<div class="col-sm-6">
									<input name="memo" id="memo2" maxlength="10" class="form-control" type="text">
								</div>
							</div>

							<div class="form-group">
								<label class="col-sm-4 control-label">商品图片：</label>
								<div class="col-sm-6">
									<input style="display: none;" onchange="img3Upload(this)" class="form-control" type="file" />
									<span onclick="filebtnclick(this)" class="glyphicon glyphicon-open fileBtn"></span>
									<img id="bannerUrl2_img" class="simg" src="">
								</div>
							</div>

							<input name="content" id="content2" class="form-control" type="hidden" value="233" />

							<input type="hidden" name="bannerUrl" id="bannerUrl2">
							<input type="hidden" name="bjUrl" id="bjUrl2" value="233">
							<input type="hidden" name="accessPath" id="rec2" value="296">
							<input type="hidden" name="type" id="par_type2">

							<input id="r_up_id2" name="id" type="hidden">
						</form>
					</div>
					<div class="modal-footer">
						<button type="button" onclick="yaodosubmit2()" class="btn btn-primary">保存</button>
						<button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
					</div>
				</div>
			</div>
		</div>

		<!--初始化-->
		<script>			
			leftInit();
			suggestInit();
			var listType = [];
			var r_list = [];
			var r_list2 = [];

			//左系列列表初始化
			function leftInit() {
				$("#table_tpl_div1").html('');
				$.ajax({
					type: "get",
					url: config + "/admin/drug/banner/listType",
					async: true,
					dataType: "jsonp",
					jsonp: "jsoncallback",
					success: function(data) {
						// console.log("左系列：：",data);
						//模板渲染
						listType = data.resultMap.listType;
						var tpl_data = {
							data: listType
						};
						var tpl_html = template.render('table_tpl1', tpl_data);
						$('#table_tpl_div1').html(tpl_html);
					},
				});

			}
			var rig_id = "";
			//左系列点击 加载右内容
			function rigclick(that) {
				$('#r_add_div').show();
				$('#r_add_div2').show();
				rig_id = $(that).attr('data-id');
				$('#par_type').val(rig_id);
				$('#par_type2').val(rig_id);
				//获取数据
				rightList(rig_id);
				//获取右2数据
				rightList2(rig_id);
			}
			//右初始化
			function rightList(id) {
				if(id == 0) {
					$("#table_tpl_div2").html('');
					return;
				}
				$("#table_tpl_div2").html('');
				$.ajax({
					type: "get",
					url: config + "/admin/drug/banner/list",
					async: true,
					dataType: "jsonp",
					data: {
						type: id
					},
					jsonp: "jsoncallback",
					success: function(data) {
						//模板渲染
						r_list = data.resultMap.list;
						console.log(r_list)
						var tpl_data = {
							data: r_list
						};
						var tpl_html = template.render('table_tpl2', tpl_data);
						$('#table_tpl_div2').html(tpl_html);
					},
				});
			}
			//右2初始化
			function rightList2(id) {
				if(id == 0) {
					$("#table_tpl_div3").html('');
					return;
				}
				$("#table_tpl_div3").html('');
				$.ajax({
					type: "get",
					url: config + "/admin/drug/bannerTwo/list",
					async: true,
					dataType: "jsonp",
					data: {
						type: id
					},
					jsonp: "jsoncallback",
					success: function(data) {
						//模板渲染
						r_list2 = data.resultMap.list;
						var tpl_data = {
							data: r_list2
						};
						var tpl_html = template.render('table_tpl3', tpl_data);
						$('#table_tpl_div3').html(tpl_html);
					},
				});

			}

			$(document).ready(function() {
//				$(".summernote").summernote({
//					lang: "zh-CN"
//				})
			});

			function modalClose() {
				$('#myModal1').modal('hide');
				$('#myModal2').modal('hide');
				$('#myModal3').modal('hide');

			}
		</script>
		<!--左系列增删改操作 验证等-->
		<script>
			function left_shang(that) {
				var index = $(that).attr('data-index');
				if(index == 0) {
					alert('调整方向成功');
					return;
				}
				var i2 = parseInt(index) - 1;
				var s_data = listType[i2];
				var data = listType[index];
				sx_up(data.id, s_data.id, function() {
					leftInit();
				});
			}

			function left_xia(that) {
				var index = $(that).attr('data-index');
				if(index == listType.length - 1) {
					alert('调整方向成功');
					return;
				}
				var i2 = parseInt(index) + 1;
				var x_data = listType[i2];
				var data = listType[index];
				sx_up(data.id, x_data.id, function() {
					leftInit();
				});
			}

			function xldosubmit() {
				$("#xlForm").submit();
			}

			$(function() {
				//保存验证
				var e = "<i class='fa fa-times-circle'></i> ";
				var xlvaForm = $("#xlForm").validate({
					submitHandler: function(form) {
						if($('#left_up_id').val() != "") {
							leftUpdate();
						} else {
							leftSave();
						}
					}
					/*,
					            rules: {
					                title: {
					                    required: !0
					                }
					            },
					            messages: {
					                title: {
					                    required: e + "系列名称不能为空"
					                }
					            }*/
				});
				//隐藏模态框时清空模态框
				$('#myModal1').on('hide.bs.modal', function() {
					xlvaForm.resetForm();
					document.getElementById("xlForm").reset();
					$('#left_up_id').val("");
					$('.simg').hide();

				});

			});

			//左保存
			function leftSave() {
				$.ajax({
//					type: "get",
					type: "post",
					url: config + "/admin/drug/banner/saveType",
					async: false,
					dataType: "jsonp",
					jsonp: "jsoncallback",
					data: formAjaxData('#xlForm'),
					success: function(data) {
						console.log("左系列保存：：", data);
						alert(data.message);
						if(data.status != 2) {
							modalClose();
							leftInit();
						}
					},
				});
			}

			//左删除
			function left_del(that) {
				var r = confirm("确定删除吗")
				if(r == true) {
					var del_id = $(that).attr('data-id');
					$.ajax({
						type: "get",
						url: config + "/admin/drug/banner/removeType",
						dataType: "jsonp",
						jsonp: "jsoncallback",
						data: {
							id: del_id
						},
						success: function(data) {
							alert(data.message);
							leftInit();
							rightList(0);
							rightList2(0);
						},
					});
				} else {

				}

			}

			//左修改
			function left_update(that) {
				var index = $(that).attr('data-index');
				var up_id = listType[index].id;
				$('#left_up_id').val(up_id);
				$('#left_title').val(listType[index].title);
			}

			function leftUpdate() {
				$.ajax({
//					type: "get",
					type: "post",
					url: config + "/admin/drug/banner/updateType",
					async: false,
					dataType: "jsonp",
					jsonp: "jsoncallback",
					data: formAjaxData('#xlForm'),
					success: function(data) {
						alert(data.message);
						if(data.status != 2) {
							modalClose();
							leftInit();
						}

					},
				});
			}
		</script>
		<!--右列表增删改 验证等-->
		<script>
//			var aHTML;
			var RichText = window.wangEditor;
			var editorDom = new RichText('#richText');
			editorDom.customConfig.pasteFilterStyle = true;
			editorDom.customConfig.uploadImgShowBase64 = true;
			editorDom.customConfig.uploadFileName = 'file';
			editorDom.customConfig.uploadImgServer = 'https://www.jhydls.cn/drugadmin/common/uploadImage';
			editorDom.customConfig.customAlert = function (info) {
				console.log(info)
			}
			editorDom.customConfig.pasteTextHandle = function (content) {
		        // content 即粘贴过来的内容（html 或 纯文本），可进行自定义处理然后返回
		        if (content == '' && !content) return ''
			    var str = content
			    str = str.replace(/<xml>[\s\S]*?<\/xml>/ig, '')
			    str = str.replace(/<style>[\s\S]*?<\/style>/ig, '')
			    str = str.replace(/<\/?[^>]*>/g, '')
			    str = str.replace(/[ | ]*\n/g, '\n')
			    str = str.replace(/&nbsp;/ig, '')
			    console.log('****', content)
			    console.log('****', str)
			    return str;
		    }
			editorDom.customConfig.customUploadImg = function (files, insert) {
				console.log(files);
				console.log(insert);
				var formData = new FormData();
    			formData.append('file', files[0]); // 固定格式
				$.ajax({
			        url:config+'/common/uploadImage',
			        type:'POST',
			        data:formData,
			        async: false,
			        cache: false,
			        dataType:'JSON', //接收值的格式
			        enctype:'multipart/form-data',
			        contentType: false,
			        processData: false,
			        success:function(data){
			        	console.log(data)
			            if(data.status!=1){
			                alert(data.message);
			            }else{
			            	insert(data.resultMap.imageUrl)
			            }
			        },
			        error: function () {
			            alert("提交失败！");
			        }
			    })
			}	
			editorDom.create();
			editorDom.txt.html('<p>请粘贴无格式文本</p>')
			function r_shang(that) {
				var index = $(that).attr('data-index');
				if(index == 0) {
					alert('调整方向成功');
					return;
				}
				var i2 = parseInt(index) - 1;

				var s_data = r_list[i2];
				var data = r_list[index];
				sx_up2(data.id, s_data.id, function() {
					rightList(rig_id);
				});
			}

			function r_xia(that) {
				var index = $(that).attr('data-index');
				if(index == r_list.length - 1) {
					alert('调整方向成功');
					return;
				}
				var i2 = parseInt(index) + 1;

				var x_data = r_list[i2];
				var data = r_list[index];
				sx_up2(data.id, x_data.id, function() {
					rightList(rig_id);
				});
			}

			function r_shang2(that) {
				var index = $(that).attr('data-index');
				if(index == 0) {
					alert('调整方向成功');
					return;
				}
				var i2 = parseInt(index) - 1;

				var s_data = r_list2[i2];
				var data = r_list2[index];
				sx_up4(data.id, s_data.id, function() {
					rightList2(rig_id);
				});
			}

			function r_xia2(that) {
				var index = $(that).attr('data-index');
				if(index == r_list2.length - 1) {
					alert('调整方向成功');
					return;
				}
				var i2 = parseInt(index) + 1;

				var x_data = r_list2[i2];
				var data = r_list2[index];
				sx_up4(data.id, x_data.id, function() {
					rightList2(rig_id);
				});
			}

			function yaodosubmit() {
//				var aHTML = $(".summernote").code();
//				console.log(aHTML)	
				var aHTML = editorDom.txt.html();
				$('#content').val(aHTML);
				$("#yaoForm").submit();
//				$("#text-elem33289988680141946").html('<p></p>');
				if($("#bannerUrl").val() != ""){
					editorDom.txt.html('<p></p>');
				}
			}

			function yaodosubmit2() {
				$("#yaoForm2").submit();
			}

			$(function() {
				//保存验证
				var e = "<i class='fa fa-times-circle'></i> ";
				var yaovaForm = $("#yaoForm").validate({
					submitHandler: function(form) {
						if($('#ryaoName').val() == "") {
							alert("请输入其他信息");
							return;
						}
						if($('#r_up_id').val() != "") {
							rUpdate();
						} else {
							rSave();
						}
					}
					/*,
					            rules: {
					                title: {
					                    required: !0
					                }
					            },
					            messages: {
					                title: {
					                    required: e + "药品名称不能为空"
					                }
					            }*/
				});
				//隐藏模态框时清空模态框
				$('#myModal2').on('hide.bs.modal', function() {
					yaovaForm.resetForm();
					document.getElementById("yaoForm").reset();
					$('#r_up_id').val("");
					$('#bannerUrl').val("");
					$('#bjUrl').val("");

					$('.simg').hide();
					$('#bannerUrl_idelbtn').hide();
					$('#bannerUrl_idelbtn1').hide();
//					$("#text-elem33289988680141946").html('<p></p>');
//					if($("#bannerUrl").val() != ""){
//						
//					}
					editorDom.txt.html('<p></p>');
				});

				//保存验证2
				var e = "<i class='fa fa-times-circle'></i> ";
				var yaovaForm2 = $("#yaoForm2").validate({
					submitHandler: function(form) {
						if($('#ryaoName2').val() == "") {
							alert("请输入其他信息");
							return;
						}
						if($('#r_up_id2').val() != "") {
							rUpdate2();
						} else {
							rSave2();
						}
					}
					/*,
					            rules: {
					                title: {
					                    required: !0
					                }
					            },
					            messages: {
					                title: {
					                    required: e + "药品名称不能为空"
					                }
					            }*/
				});
				//隐藏模态框时清空模态框
				$('#myModal3').on('hide.bs.modal', function() {
					yaovaForm2.resetForm();
					document.getElementById("yaoForm2").reset();
					$('#r_up_id2').val("");
					$('#bannerUrl2').val("");
					$('#bjUrl2').val("");
					$('.simg').hide();

				});

			});

			//右保存
			function rSave() {
				$.ajax({
					type: "get",
					url: config + "/admin/drug/banner/save",
					async: false,
					dataType: "jsonp",
					jsonp: "jsoncallback",
					data: formAjaxData('#yaoForm'),
					success: function(data) {
						console.log("右系列保存：：", data);
						alert(data.message);
						if(data.status != 2) {
							modalClose();
							rightList(rig_id);
						}

					},
				});
			}
			//右保存2
			function rSave2() {
				$.ajax({
					type: "get",
					url: config + "/admin/drug/bannerTwo/save",
					async: false,
					dataType: "jsonp",
					jsonp: "jsoncallback",
					data: formAjaxData('#yaoForm2'),
					success: function(data) {
						alert(data.message);
						if(data.status != 2) {
							modalClose();
							rightList2(rig_id);
						}

					},
				});
			}

			//右删除
			function r_del(that) {
				var r = confirm("确定删除吗？")
				if(r == true) {
				var del_id = $(that).attr('data-id');
				$.ajax({
					type: "get",
					url: config + "/admin/drug/banner/remove",
					dataType: "jsonp",
					jsonp: "jsoncallback",
					data: {
						id: del_id
					},
					success: function(data) {
						alert(data.message);
						rightList(rig_id);
					},
				});
				}
			}

			function r_del2(that) {
				var r = confirm("确定删除吗？")
				if(r == true) {
					var del_id = $(that).attr('data-id');
					$.ajax({
						type: "get",
						url: config + "/admin/drug/bannerTwo/remove",
						dataType: "jsonp",
						jsonp: "jsoncallback",
						data: {
							id: del_id
						},
						success: function(data) {
							alert(data.message);
							rightList2(rig_id);
						},
					});
				} else {}

			}

			//右修改
			function r_update(that) {
				var index = $(that).attr('data-index');
				var data = r_list[index];
				console.log(data);
				//赋值模态框
				$('#ryaoName').val(data.title);
				$('#rec').val(data.accessPath);
				$('#memo').val(data.memo);
				$('#price').val(data.price);
				$('#bannerUrl').val(data.bannerUrl);
				$('#bjUrl').val(data.bjUrl);
				$('#content').val(data.content);
//				$(".summernote").code(data.content);
				editorDom.txt.html(data.content);
//				$("#text-elem9246290398265407").code(data.content);
				$('#r_up_id').val(data.id);
				$('#bannerUrl_img').attr('src', data.bannerUrl);
				$('#bannerUrl_img').show();
				$('#bjUrl_img').attr('src', data.bjUrl);
				$('#bjUrl_img').show();
				$('#bannerUrl_idelbtn').show();
				if($('#bjUrl_img').attr('src') != "") $('#bannerUrl_idelbtn1').show();
			}
			//右修改2
			function r_update2(that) {
				var index = $(that).attr('data-index');
				var data = r_list2[index];
				
				//赋值模态框
				$('#ryaoName2').val(data.title);
				$('#rec2').val(data.accessPath);
				$('#memo2').val(data.memo);
				$('#bannerUrl2').val(data.bannerUrl);
				$('#bjUrl2').val(data.bjUrl);
				$('#content2').val(data.content);
				$('#r_up_id2').val(data.id);

				$('#bannerUrl2_img').attr('src', data.bannerUrl);
				$('#bannerUrl2_img').show();
			}

			function rUpdate() {
				$.ajax({
					type: "get",
					url: config + "/admin/drug/banner/update",
					async: false,
					dataType: "jsonp",
					jsonp: "jsoncallback",
					data: formAjaxData('#yaoForm'),
					success: function(data) {
						alert(data.message);
						if(data.status != 2) {
							modalClose();
							rightList(rig_id);
						}

					},
				});
			}

			function rUpdate2() {
				$.ajax({
					type: "get",
					url: config + "/admin/drug/bannerTwo/update",
					async: false,
					dataType: "jsonp",
					jsonp: "jsoncallback",
					data: formAjaxData('#yaoForm2'),
					success: function(data) {
						alert(data.message);
						if(data.status != 2) {
							modalClose();
							rightList2(rig_id);
						}
					},
				});
			}
		</script>
		<!--图片上传-->
		<script>
			function img1Upload(that) {
				uploadImg(that, function(url) {
					$('#bannerUrl').val(url);
					$(that).parent().find('.simg').attr('src', url);
					$(that).parent().find('.simg').show();
					$('#bannerUrl_idelbtn').show();
				});
			}

			function img2Upload(that) {
				uploadImg(that, function(url) {
					$('#bjUrl').val(url);
					$(that).parent().find('.simg').attr('src', url);
					$(that).parent().find('.simg').show();
					$('#bannerUrl_idelbtn1').show();
				});
			}

			function img3Upload(that) {
				uploadImg(that, function(url) {
					$('#bannerUrl2').val(url);
					$(that).parent().find('.simg').attr('src', url);
					$(that).parent().find('.simg').show();
				});
			}
			//图片删除
			function delImg_banner(that) {
				console.log(that)
				$(that).attr("id") == "bannerUrl_idelbtn1" ? $("#bjUrl").val("") : $("#bannerUrl").val("");
				$(that).attr("id") == "bannerUrl_idelbtn1" ? $("#bgImg").val("") : $("#bannerImg").val("");
				$(that).parent().find('.simg').hide();
				$(that).hide();
			}
		</script>
	</body>

</html>